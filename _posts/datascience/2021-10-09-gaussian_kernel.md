---
layout: post
current: post
cover: assets/built/images/gaussian-kernel-formula.jpeg
navigation: True
title: Gaussian Kernel
date: 2021-10-08 22:30:00 +0900
tags: [datascience]
use-math: True
class: post-template
subclass: 'post tag-datascience'
author: GyuhoonK
---



Gaussian Kernel(RBF) ê¸°ë³¸ ê°œë…ì— ëŒ€í•˜ì—¬

# Gaussian Kernel ?

Gaussian Kernel, í˜¹ì€ RBF(Radial Basis Function)ë¼ê³ ë„ ë¶ˆë¦¬ìš°ëŠ” ì´ ê¸°ë²•ì€ ì»¤ë„ í•¨ìˆ˜(Kernel Function) ì¤‘ ì €ì°¨ì›ì—ì„œ ê³ ì°¨ì›ìœ¼ë¡œ ë§¤í•‘ì‹œí‚¤ëŠ” ê¸°ë²•(mapping function) ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. íŠ¹íˆ, Gaussian Kernelì€ ë°ì´í„° ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ë¬´í•œì°¨ì› ë²¡í„°ê³µê°„ì—ì„œ ì¸¡ì •í•©ë‹ˆë‹¤.



# What is Kernel ?

ë¨¼ì €, ì €ì°¨ì›ì—ì„œ ê³ ì°¨ì›ìœ¼ë¡œ mappingí•˜ê¸° ìœ„í•´ì„œëŠ” ì‚¬ìš©ë˜ëŠ” functionì€ ë§¤í•‘ ì´í›„ ê³ ì°¨ì›ì—ì„œ ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ëª©ì ì´ ì•„ë‹™ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ í™•ì¸í•˜ê³  ì‹¶ì€ ê°’ì€ ê³ ì°¨ì›ìœ¼ë¡œ ë§¤í•‘ëœ ì´í›„ ë‘ ë°ì´í„°ì˜ ë‚´ì ê°’(inner product)ì…ë‹ˆë‹¤. ë‚´ì ê°’ì€ ìŠ¤ì¹¼ë¼ê°’ìœ¼ë¡œ ë°˜í™˜ë˜ê³  ì´ë¥¼ í†µí•´ ê³ ì°¨ì›ì— ë§¤í•‘ëœ ë‘ ë²¡í„° ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](../../assets/built/images/inner-product.png)

ê·¸ëŸ¬ë‚˜ ê³ ì°¨ì› ë§¤í•‘ ì´í›„ ë‚´ì (inner product)ë¥¼ ê³„ì‚°í•˜ì—¬ ë‘ ë²¡í„° ê°„ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ëŠ” ë°©ë²•ì€ ê³„ì‚°ëŸ‰ì´ ë§¤ìš° ë†’ì•„ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤. 

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Kernel Trickì´ ì´ìš©ë©ë‹ˆë‹¤. Kernel Trickì€ ê³ ì°¨ì› ë§¤í•‘ê³¼ ë‚´ì  ê³„ì‚°ì„ í•œë²ˆì— ìˆ˜í–‰í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ ë™ì‹œ ì—°ì‚°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒì´ Kernelì…ë‹ˆë‹¤.

ì €ì°¨ì›(m)ì—ì„œ ê³ ì°¨ì›(n)ìœ¼ë¡œ ë§¤í•‘ì‹œì¼œì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•©ë‹ˆë‹¤.


$$
\phi(x) = Ax \\
A : n * m (n>m)\\
x : m * 1
$$


ìœ„ í•¨ìˆ˜ëŠ”  mì°¨ì› ë²¡í„°ë¥¼ nì°¨ì›ìœ¼ë¡œ ë§¤í•‘ì‹œì¼œì¤ë‹ˆë‹¤. ì´ ë•Œ, Î¦ëŠ” ì„ í˜•ë³€í™˜(Linear Transformation)ì´ê³ , í–‰ë ¬ ğ´(n x m)ëŠ” ì„ í˜•ë³€í™˜ì— ì‚¬ìš©ë˜ëŠ” í‘œì¤€í–‰ë ¬ì…ë‹ˆë‹¤.

ìœ„ì—ì„œ ë§í–ˆë“¯ì´, ì´ëŸ¬í•œ ë§¤í•‘ì´í›„ ìš°ë¦¬ê°€ ê³„ì‚°í•˜ê³  í•˜ëŠ” ê²ƒì€ ë‘ ë²¡í„°ì˜ ë³€í™˜ ì´í›„ ë‚´ì ê°’ì…ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì€ ìˆ˜ì‹ìœ¼ë¡œ ğ¾(Kernel)ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


$$
K(x_{i}, x_{j}) = \phi(x_{i})^T \phi(x_{j})
							  =  (Ax_{i})^T (Ax_{j})
							  = x_{i}^TA^TAx_{j}
$$


ì´ ë•Œ, ìœ„ ì‹ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ë“¤ì˜ ì°¨ì›ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.


$$
x_{i}^T : 1 * m \\
A^T : m * n\\
A : n * m \\
x_{j} : m * 1
$$


ê²°ê³¼ì ìœ¼ë¡œ ğ¾ëŠ” ìŠ¤ì¹¼ë¼ê°’ì„ ë°˜í™˜í•˜ê²Œ ë¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğ¾ê°€ ë‘ ë²¡í„°ê°„ì˜ ê±°ë¦¬(ìœ ì‚¬ë„)ë¥¼ ì¸¡ì •í•œë‹¤ëŠ” ì ì—ì„œ ì•„ë˜ ë‘ ê°€ì§€ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼í•©ë‹ˆë‹¤.


$$
i) K(x_{i}, x_{j}) = K(x_{j}, x_{i}) \\
ii) K(x_i, x_i) >= 0
$$


ì¦‰, êµí™˜ë²•ì¹™ì´ ì„±ë¦½í•´ì•¼í•˜ê³  ìê¸°ìì‹ ê³¼ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í–ˆì„ ë•Œì—ëŠ” ìŒìˆ˜ê°’ì´ ë‚˜ì™€ì„œëŠ” ì•ˆëœë‹¤ëŠ” ì¡°ê±´ì…ë‹ˆë‹¤.

ì´ëŸ¬í•œ ì¡°ê±´ì„ ë§Œì¡±í•˜ê¸° ìœ„í•œ ì¡°ê±´ì„ ê³„ì‚°í•´ë³´ë©´, ğ¾ë¥¼ ì´ë£¨ëŠ” í–‰ë ¬ë“¤ì´

â€‹	ğ¢) ëŒ€ì¹­í–‰ë ¬(symetric matrix) 

â€‹	ğ¢ğ¢) positive semi-definite matrix

ë¥¼ ë™ì‹œì— ë§Œì¡±í•´ì•¼í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ì™€ ê´€ë ¨ëœ ì¡°ê±´ì€ **Mercer's Theorem**ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](../../assets/built/images/mercer.png)

ì´ëŸ¬í•œ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì»¤ë„ì—ëŠ” *Linear, polynomial, sigmoid* ê·¸ë¦¬ê³  ì§€ê¸ˆ ìš°ë¦¬ê°€ ì‚´í´ë³´ê³  ìˆëŠ” ***gaussian***ì´ ìˆìŠµë‹ˆë‹¤.



## Gaussian Kernel - Infinite-dimensional vector

Gaussian Kernelì˜ ê°€ì¥ í° íŠ¹ì§•ì€ ë¬´í•œì°¨ì›ìœ¼ë¡œ ë§¤í•‘ì‹œí‚¨ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì•„ë˜ ì‹ì„ í†µí•´ ê°„ë‹¨í•œ ì˜ˆë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³„ì‚° í¸ì˜ì„±ì„ ìœ„í•´ $$\sigma^2=\dfrac {1}{2}$$ì¸ ê²½ìš°ë¥¼ ì˜ˆì‹œë¡œ ì„ íƒí–ˆìŠµë‹ˆë‹¤.


$$
K(x_{i}, x_{j}) = exp(-\dfrac {||x_i - x_j||^2}{2\sigma^2})\\
K(x_{i}, x_{j}) = exp(-{||x_i - x_j||^2}) \text{ (when } \sigma^2=\dfrac {1}{2} \text{)}\\
=exp(-x_i^2)exp(-x_j^2)exp(2x_ix_j)\\
\text {By Taylor's theorem,  } exp(2x_ix_j) = \Sigma_{k=0}^{\infty}(\dfrac {2^kx_i^kx_j^k}{k!})
$$

## Gaussian Kernel - Purpose of ğ›”

ğ›”ëŠ” ë¬´í•œì°¨ì›ìœ¼ë¡œ í™•ì¥ëœ ë²¡í„° ì‚¬ì´ì˜ ê±°ë¦¬ ê³„ì‚° ì‹œ ì–¼ë§ˆë‚˜ ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•˜ëŠ”ì§€ ê²°ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜ì…ë‹ˆë‹¤.

![image](../../assets/built/images/gaussian-plot.png)

ìœ„ ê·¸ë¦¼ì²˜ëŸ¼, $$K(x)$$ ì¦‰ Gaussian Kernelì˜ ê³„ì‚° ê²°ê³¼ëŠ” ğ›”ê°€ í´ìˆ˜ë¡ ë²¡í„° ê°„ ê±°ë¦¬ $$x$$ì˜ ì°¨ì´ì— ë‘”ê°í•´ì§‘ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ ğ›”ê°€ ì‘ì•„ì§€ë©´, ë²¡í„° ê°„ ê±°ë¦¬ $$x$$ì— ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤.

# How to Use ?

Kernel SVM, Kernel Regressionì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ê°ê° ì˜ˆë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

## Kernel SVM

SVM Classificationì€ ë¹„ì„ í˜• ë¶„ë¥˜ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤ëŠ” í•œê³„ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì €ì°¨ì› ê³µê°„ì˜ ë°ì´í„°ë¥¼ ê³ ì°¨ì› ê³µê°„ìœ¼ë¡œ ë§¤í•‘ì‹œì¼œ ì´ˆí‰ë©´ì„ ì°¾ì•„ SVMì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ ì í•©ë‹ˆë‹¤.

![image](../../assets/built/images/kernel-svm.png)



## Kernel Regression 

[ì—…ë°ì´íŠ¸ ì˜ˆì •]



[ì°¸ê³ ]

[https://ratsgo.github.io/machine%20learning/2017/05/30/SVM3/](https://ratsgo.github.io/machine%20learning/2017/05/30/SVM3/)

[https://tensorflow.blog/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D/2-3-7-%EC%BB%A4%EB%84%90-%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0/](https://tensorflow.blog/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D/2-3-7-%EC%BB%A4%EB%84%90-%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0/)